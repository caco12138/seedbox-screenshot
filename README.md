# 种子盒截图脚本
本脚本为个人使用，旨在帮助用户从视频文件中批量生成随机无损 PNG 截图，并可选进行无损压缩，主要用于 Linux 环境（Debian 系），提高种子转发的效率。。  

由于在使用盒子进行大量转种的时候，许多种子的截图链接已经失效或者质量不过关。所以为了方便用盒子批量截取高质量png图片并且打包，使用GPT写了此脚本来提高个人转种效率。

压缩工具选地使用 `oxipng` ，而不是`OptiPNG`。`OptiPNG`是一款优秀的老牌png无损压缩工具，但是并不支持多核处理，在一些性能较弱的盒子里，压缩进程一般非常缓慢。 

而`oxipng`同样是一款png无损压缩工具，在多核多线程条件的加持下，压缩速度更快，压缩效果更好，非常适合大部分盒子压缩图片的场景。但是`oxipng`的缺点是在大部分常用 Linux 发行版的官方软件库中可能不自带，所以本脚本提供了一键安装和卸载的功能(暂只支持amd架构)。

若不熟悉命令行操作，可以尝试使用魔改版的filebrowser
## 一.功能

1. **从视频中生成随机截图**：使用 `ffmpeg` 从指定视频中生成任意数量的随机无损png截图。
2. **图片压缩**：通过 `oxipng` 无损压缩生成的 PNG 图片（可选）。
3. **截图打包**：自动将生成的截图打包为一个 ZIP 文件，方便下载到本地进行筛选后再选择性上传到图床。
4. **多线程压缩**：默认开启多线程对截图进行并行压缩，提高处理效率。如果盒子性能较弱，可以选择关闭多线程。
5. **自动安装/卸载 `oxipng`**：支持 `x86_64` Linux 系统一键安装 `oxipng`，`ARM` 架构暂不支持。

## 二.环境要求

- **操作系统**：Linux（主要为debian系，其他系统未测试，支持arm架构）。
- **测试环境**: netcup rs1000 G9.5(debian11), 甲骨文Oracle ARM(ubuntu22.04)
- **依赖工具**：
  - `ffmpeg`：用于从视频中截取图片。
  - `oxipng`（可选）：用于压缩 PNG 图片。
  - `Python 3.x`：脚本基于 Python 3.x 开发。

## 三.安装依赖

在使用此脚本之前，请确保你的系统已安装以下工具：

- **安装 ffmpeg**：
  
  ```bash
  sudo apt-get update
  sudo apt-get install ffmpeg
  ```

- **安装 oxipng（可选，若无需压缩需求，不用安装。一键安装仅 x86_64 架构支持）**：
  
  使用以下命令一键安装 `oxipng`：
  
  ```bash
  python3 script.py oxipng
  ```

  如果你使用的是 `ARM` 架构（如 `aarch64`），脚本将会提示不支持自动安装。

## 四.使用方法

### (1)截图和压缩功能

运行以下命令从视频文件中生成指定数量的随机无损png截图，并且保存在**screenshots**文件夹,自动打包为zip：

```bash
python3 script.py 视频文件 截图数量 [压缩质量] [-t]
```

- **视频文件**：要处理的视频文件的路径。
- **截图数量**：需要生成的截图数量，必须为正整数。
- **压缩质量**（可选）：指定图片的压缩质量，范围为 1 到 6，对应`oxipng`压缩的6个等级，数字越大，压缩效果越好，处理时间越长。仅当系统安装了 `oxipng` 时有效。
- **-t**（可选）：关闭多线程模式，使用单线程进行压缩，适合低性能盒子。

#### 示例

1. 最基础的用法，生成 5 张随机截图，不传入压缩质量参数，根据截图大小手动确认是否压缩

   ```bash
   python3 script.py /path/to/video.mp4 5
   ```
    截图将保存在脚本运行目录的**screenshots**文件夹,并且自动打包为zip。  
    若循环使用命令，新的截图和zip文件会自动覆盖旧的所有文件

2. 生成 5 张随机截图，并使用 `oxipng` 压缩，压缩质量为 3：

   ```bash
   python3 script.py /path/to/video.mp4 10 3
   ```

3. 生成 5 张截图，并且使用单线程模式进行压缩：

   ```bash
   python3 script.py /path/to/video.mp4 5 4 -t
   ```

4. 生成 5 张截图，不传入压缩质量参数，根据截图大小确认是否压缩，并且使用单线程模式进行压缩：

   ```bash
   python3 script.py /path/to/video.mp4 5 -t
   ```

### (2)`oxipng` 的安装与卸载

- **安装 `oxipng`**：

  如果你使用的是 `x86_64` 架构的 Linux 系统，运行以下命令一键下载安装 `oxipng`：

  ```bash
  python3 script.py oxipng
  ```

  `ARM` 架构暂不支持自动安装 `oxipng`，脚本会提示不支持该架构的安装。

- **卸载 `oxipng`**：

  如果需要卸载 `oxipng`，可以运行以下命令：

  ```bash
  python3 script.py unoxipng
  ```

## 注意事项

1. **ffmpeg 必须预先安装**：脚本依赖 `ffmpeg` 进行截图操作，如果 `ffmpeg` 未安装，脚本将会退出并提示错误。
2. **oxipng 压缩为可选项**：如果 `oxipng` 未安装，脚本仍然可以正常工作，但压缩功能将不可用。你可以在需要时通过 `python3 script.py oxipng` 安装 `oxipng`。
3. **截图数量过多警告**：如果生成的截图数量超过 50，脚本会给出警告并询问用户是否继续操作。
